---
layout: post
title:  "TIL"
categories: ['TIL']
---

## XlsxWriter사용

[공식 문서](https://xlsxwriter.readthedocs.io/)

### worksheet.insert_image의 이미지 타입 제한

worksheet.insert_image에는 gif타입 이미지를 사용할 수 없으므로, 사용하려면 Pillow를 사용해서 png나 jpg로 변환 후 삽입

```python
# requests를 사용해서 HTTP GET요청
response = requests.get(<이미지의 URL>)
# 요청 결과의 내용을 original_image_content 변수에 할당
original_image_data = response.content
# gif이미지를 png로 변환해서 해당 내용을 저장할 Byte형 메모리 파일객체를 생성
convert_image_data = BytesIO()
# BytesIO객체에 Pillow를 사용해서 PNG타입으로 이미지 형식을 바꿔 저장
Image.open(original_image_data).save(convert_image_data, 'PNG')
# worksheet에 해당 이미지를 삽입
worksheet.insert_image(<행>, <열>, <이미지 파일 이름>, {'image_data': convert_image_data})
```
